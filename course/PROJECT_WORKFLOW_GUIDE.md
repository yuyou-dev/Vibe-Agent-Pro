# ğŸ“˜ é¡¹ç›®å¼€å‘ä¸éƒ¨ç½²å·¥ä½œæµæŒ‡å— (Project Workflow Guide)

æœ¬æ–‡æ¡£æ—¨åœ¨å¸®åŠ©å¼€å‘è€…äº†è§£å¦‚ä½•åˆ©ç”¨é¡¹ç›®ä¸­çš„æ ‡å‡†åŒ– Skillï¼Œå®Œæˆä»ä¸‹è½½æºç åˆ°ç”Ÿäº§éƒ¨ç½²çš„å…¨æµç¨‹ã€‚æœ¬å¥—æµç¨‹ä¸“ä¸ºè§£å†³ **AI é€»è¾‘éš”ç¦»** å’Œ **ç”Ÿäº§ç¯å¢ƒä¸€è‡´æ€§** è€Œè®¾è®¡ã€‚

---

## ğŸš¦ æ ¸å¿ƒæµç¨‹æ€»è§ˆ (Workflow Overview)

| é˜¶æ®µ | ç›®æ ‡ | æ¶‰åŠ Skill | å…³é”®åŠ¨ä½œ |
| :--- | :--- | :--- | :--- |
| **0. åˆå§‹åŒ–** | å¯åŠ¨æœ¬åœ°ä»£ç†ï¼Œæ‰“é€š Gemini API | `gemini-local-dev` | åˆ›å»º `.env`, è¿è¡Œ Proxy |
| **1. é€»è¾‘é‡æ„** | å°†æ•æ„Ÿ AI é€»è¾‘ç§»å…¥åç«¯ (BFF) | `isolate-backend-logic` | åˆ›å»º `middleware.cjs`, é…ç½® Vite ä»£ç† |
| **2. éƒ¨ç½²å‡†å¤‡** | æ¶ˆé™¤æœ¬åœ°/çº¿ä¸Šå·®å¼‚ï¼Œæ‰“åŒ…å‘å¸ƒ | `production-deploy-prep` | åŒæ­¥ `template_app.js`, è‡ªåŠ¨ç”Ÿæˆ PM2 é…ç½® |

---

## ğŸ› ï¸ é˜¶æ®µè¯¦è§£ (Step-by-Step)

### é˜¶æ®µ 0: ğŸš€ å¯åŠ¨æœ¬åœ°å¼€å‘ (Local Initialization)
**åœºæ™¯**: åˆšä» AI Studio ä¸‹è½½ä»£ç ï¼Œéœ€è¦åœ¨æœ¬åœ°è¿è¡Œå¹¶è°ƒè¯•ã€‚

1.  **ç›®æ ‡**: è§£å†³ API è·¨åŸŸå’Œé‰´æƒé—®é¢˜ï¼Œè®©å‰ç«¯èƒ½è°ƒé€š Gemini æ¨¡å‹ã€‚
2.  **æ“ä½œ**:
    *   åœ¨æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼Œå¡«å…¥ `AUTH_SECRET` å’Œ `TARGET_BASE_URL`ã€‚
    *   å¯åŠ¨æœ¬åœ°ä»£ç†æœåŠ¡å™¨ï¼ˆé€šå¸¸ç”± Skill è‡ªåŠ¨ç”Ÿæˆ `server.cjs` æˆ– `middleware.cjs`ï¼‰ã€‚
3.  **Skill ä¸€å¥è¯è§¦å‘**:
    > "å¸®æˆ‘åˆ›å»ºæœ¬åœ°å¼€å‘ä»£ç†ï¼Œè¿æ¥åˆ° Gemini æ¥å£ã€‚"

---

### é˜¶æ®µ 1: ğŸ›¡ï¸ åˆ†ç¦»åç«¯é€»è¾‘ (Isolate Backend Logic)
**åœºæ™¯**: å‰ç«¯åŠŸèƒ½è°ƒé€šäº†ï¼Œä½† Prompt å’Œ API Key æš´éœ²åœ¨å‰ç«¯ä»£ç ä¸­ï¼Œéœ€è¦é‡æ„ã€‚

1.  **ç›®æ ‡**: å»ºç«‹ BFF (Backend for Frontend) å±‚ï¼Œä¿æŠ¤çŸ¥è¯†äº§æƒ (IP)ã€‚
2.  **Skill æ ¸å¿ƒé€»è¾‘**:
    *   **åˆ†æ**: æ‰«æå‰ç«¯ä»£ç ï¼Œæå– Prompt å’Œæ¨¡å‹å‚æ•°ã€‚
    *   **å®ç°**: åˆ›å»º `middleware.cjs`ï¼Œæš´éœ²ä¸šåŠ¡æ¥å£ (å¦‚ `/api/roast`) è€Œéé€šç”¨æ¨¡å‹æ¥å£ã€‚
    *   **è¿æ¥**: é…ç½® `vite.config.ts` çš„ Proxyï¼Œè§£å†³æœ¬åœ°è·¨åŸŸï¼›å‰ç«¯æ”¹ä¸ºç›¸å¯¹è·¯å¾„è°ƒç”¨ã€‚
3.  **Skill ä¸€å¥è¯è§¦å‘**:
    > "å°†æ ¸å¿ƒ AI é€»è¾‘é‡æ„åˆ°ä¸­é—´å±‚ã€‚"

---

### é˜¶æ®µ 2: ğŸ“¦ å‡†å¤‡ç”Ÿäº§å‘å¸ƒ (Production Prep)
**åœºæ™¯**: æœ¬åœ°å¼€å‘å®Œæˆï¼Œå‡†å¤‡éƒ¨ç½²åˆ°è…¾è®¯äº‘/é˜¿é‡Œäº‘æœåŠ¡å™¨ (Node.js/PM2)ã€‚

1.  **ç›®æ ‡**: ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¾èµ–ã€é…ç½®å’Œå¯åŠ¨è„šæœ¬çš„ç‹¬ç«‹éƒ¨ç½²åŒ…ã€‚
2.  **Skill æ ¸å¿ƒé€»è¾‘**:
    *   **ä¸€è‡´æ€§æ£€æŸ¥**: **è¿™æ˜¯æœ€é‡è¦çš„ä¸€æ­¥**ã€‚è‡ªåŠ¨æ¯”å¯¹å¼€å‘ç¯å¢ƒ (`middleware.cjs`) å’Œç”Ÿäº§æ¨¡ç‰ˆ (`template_app.js`) çš„æ¨¡å‹ç‰ˆæœ¬ (v1.5/v2.5) ä¸ Prompt æ˜¯å¦ä¸€è‡´ã€‚
    *   **è·¯ç”±ä¿®æ­£**: è‡ªåŠ¨ä¿®å¤ Express 5.0 çš„è·¯ç”±å…¼å®¹æ€§é—®é¢˜ (ä½¿ç”¨ `app.get(/.*/)`)ã€‚
    *   **è‡ªåŠ¨åŒ–æ‰“åŒ…**: ç”Ÿæˆ `dist_bundle/release` ç›®å½•ï¼Œå†…å« `package.json`, `ecosystem.config.cjs` ç­‰æ‰€æœ‰æ–‡ä»¶ã€‚
3.  **Skill ä¸€å¥è¯è§¦å‘**:
    > "å¸®æˆ‘å‡†å¤‡è¿™ä¸ªé¡¹ç›®çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²åŒ…ã€‚"

---

## ğŸ§ª æ ‡å‡†æµ‹è¯•ç”¨ä¾‹ (Standard Test Case)

åœ¨å¯åŠ¨æ–°é¡¹ç›®æ—¶ï¼Œå¤åˆ¶ä»¥ä¸‹ Prompt ç»™ AI Agentï¼Œå¯ä¸€æ¬¡æ€§éªŒè¯æ‰€æœ‰ Skill æ˜¯å¦å°±ç»ªï¼š

```text
æˆ‘æ­£åœ¨å¯åŠ¨ä¸€ä¸ªæ–°çš„ Vite å‰ç«¯é¡¹ç›®ï¼š
1. è¯·å…ˆå¸®æˆ‘åº”ç”¨ "Geminiæœ¬åœ°å¼€å‘åè®®"ï¼Œåˆ›å»ºä»£ç†å¹¶è¿è¡Œã€‚
2. æ¥ç€ï¼Œè¯·åº”ç”¨ "ä¸­é—´å±‚é€»è¾‘éš”ç¦»" Skillï¼Œå°†ç¡¬ç¼–ç çš„ Prompt ç§»å…¥ middleware.cjsã€‚
3. æœ€åï¼Œåº”ç”¨ "ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²åè®®"ï¼Œå¸®æˆ‘æ‰“åŒ…ä¸€ä¸ªå¯ä»¥ç›´æ¥ä¸Šä¼ æœåŠ¡å™¨çš„ dist_bundleã€‚
```

---

## ğŸ“ ç›®å½•ç»“æ„å‚è€ƒ

```
project-root/
â”œâ”€â”€ .agent/skills/               # æŠ€èƒ½åº“
â”‚   â”œâ”€â”€ gemini-local-dev/        # é˜¶æ®µ 0 Skill
â”‚   â”œâ”€â”€ isolate-backend-logic/   # é˜¶æ®µ 1 Skill
â”‚   â””â”€â”€ production-deploy-prep/  # é˜¶æ®µ 2 Skill
â”œâ”€â”€ middleware.cjs               # æœ¬åœ°å¼€å‘ç”¨çš„ä¸­é—´å±‚ (BFF)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ bundle.cjs               # æ‰“åŒ…è„šæœ¬
â”‚   â””â”€â”€ template_app.js          # ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨æ¨¡ç‰ˆ (éœ€ä¸ middleware.cjs ä¿æŒåŒæ­¥)
â””â”€â”€ dist_bundle/release/         # æœ€ç»ˆç”Ÿæˆçš„éƒ¨ç½²åŒ…
    â”œâ”€â”€ app.js                   # ç”Ÿäº§è¿è¡Œå…¥å£
    â”œâ”€â”€ ecosystem.config.cjs     # PM2 é…ç½®
    â””â”€â”€ public/                  # å‰ç«¯é™æ€èµ„æº
```
